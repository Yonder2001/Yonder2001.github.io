---
title: "Global Happiness Level Report"
---
<style>
  h1 {
    text-align: center;
  }
</style>
```{r load-packages, message=FALSE, echo=FALSE,Warning=FALSE}
library(tidyverse)
library(plotly)
library(ggplot2)
```

```{r,echo=FALSE, Warning = FALSE}
#Dataset 1

LS_Summery <- read.csv("C:/Users/ouyangshuting/Desktop/NM2207/Yonder2001.github.io/Data/Happiness Score 2019-2024 .csv")

#Tidying LS_Summery
LS_Summery_long <- LS_Summery %>% 
  pivot_longer(cols = c(-Country), names_to = "Years",values_to = "Ladder Score")

Tidy_LS_Summery <- LS_Summery_long %>% 
  pivot_wider(names_from = Country, values_from = "Ladder Score")


#Tidying HR_Summery
HR_Summery<-read.csv("C:/Users/ouyangshuting/Desktop/NM2207/Yonder2001.github.io/Data/Happiness Ranking 2019-2024.csv")

HR_Summery_long <- HR_Summery %>% 
  pivot_longer(cols = c(-Country), names_to = "Years",values_to = "Happiness Rank")

Tidy_HR_Summery <- HR_Summery_long %>% 
  pivot_wider(names_from = Country, values_from = "Happiness Rank")

#Muate Variance 
HR_Summery_long <- HR_Summery_long %>%
  group_by(Country) %>%
  mutate(variance = var(`Happiness Rank`))

LS_Summery_long <- LS_Summery_long %>%
  group_by(Country) %>%
  mutate(variance = var(`Ladder Score`))

#Check Variance 
HR_BigVariance <- HR_Summery_long %>%
  filter(variance > 100)
HR_Unchange <- HR_Summery_long %>%
  filter(variance <20)
LS_BigVariance <- LS_Summery_long %>%
  filter(variance > 0.1)
LS_Unchange <- LS_Summery_long %>%
  filter(variance <0.003)
```


```{=html}
<iframe height="400" width="100%" frameborder="no" src="https://shutingouyang.shinyapps.io/Happiness_Global/"> </iframe>
```


```{r,echo=FALSE, Warning = FALSE}
#Draw Line Graph for big variaed country
LS_line_graph <- ggplot(data = LS_BigVariance, 
                        aes(x = Years, 
                            y = `Ladder Score`, 
                            group = Country)) +
  geom_line(aes(color = Country,alpha = 0.7)) +
  geom_point(aes(color = Country))+ 
  scale_color_viridis_d()

LS_line_graph_plotly <- ggplotly(LS_line_graph)
LS_line_graph_plotly
```
```{r,echo=FALSE, Warning = FALSE}

#Draw Line graph for no chnge country 
LS_line_graph <- ggplot(data = LS_Unchange, 
                        aes(x = Years, 
                            y = `Ladder Score`, 
                            group = Country)) +
  geom_line(aes(color = Country)) +
  geom_point(aes(color = Country))+ scale_color_viridis_d()

LS_line_graph_plotly <- ggplotly(LS_line_graph)
LS_line_graph_plotly
```


```{=html}
<iframe height="400" width="100%" frameborder="no" src="https://shutingouyang.shinyapps.io/6FactorsExplained/"> </iframe>
```

